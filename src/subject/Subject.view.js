import { SubjectModel } from "./Subject.model";
import * as React from "react";
import { useContext, useState } from "react";
import ExpandLessIcon from '@mui/icons-material/ExpandLess';
import ExpandMoreIcon from '@mui/icons-material/ExpandMore';
import AddCircleIcon from '@mui/icons-material/AddCircle';
import DeleteIcon from '@mui/icons-material/Delete';
import { WorkPanelContext } from "../workpanel/WorkPanel.view";
import { UpdateMode } from "../workpanel/WorkPanel.controller";
const SubjectView = ({ subject }) => {
    const workPanelController = useContext(WorkPanelContext);
    const [isExpanded, setIsExpanded] = useState(false);
    const [isEditing, setIsEditing] = useState(false);
    const [name, setName] = useState(subject.name);
    const handleAddChild = () => {
        const newSubject = SubjectModel.newInstance();
        newSubject.parentID = subject.id;
        workPanelController.updateSubject(newSubject, UpdateMode.ADD);
        setIsExpanded(true);
    };
    const handleDelete = () => {
        workPanelController.updateSubject(subject, UpdateMode.DELETE);
    };
    const handleUpdateName = () => {
        const newSubject = Object.assign({}, subject, { name: name });
        workPanelController.updateSubject(newSubject);
        setIsEditing(false);
    };
    const handleCancelEdit = () => {
        setIsEditing(false);
        setName(subject.name);
    };
    const handleExpand = () => {
        setIsExpanded(!isExpanded);
    };
    const handleNameChange = (event) => {
        setName(event.target.value);
    };
    const handleNameKeyPress = (event) => {
        if (event.key === 'Enter') {
            handleUpdateName();
        }
    };
    const renderChildren = () => {
        if (subject.children.length === 0) {
            return null;
        }
        return (React.createElement("div", { style: { marginLeft: 20 } }, subject.children.map((child) => (React.createElement(SubjectView, { subject: child })))));
    };
    return (React.createElement("div", { style: { maxHeight: 400, overflowY: 'scroll' } },
        React.createElement("div", { className: 'workflow-container-inner', style: { display: 'flex', flexDirection: 'row', alignItems: 'center', marginTop: 3 } },
            React.createElement("div", { style: { display: 'flex', alignItems: 'center', marginRight: 3 }, onClick: handleExpand }, isExpanded ? React.createElement(ExpandLessIcon, { fontSize: 'inherit' }) : React.createElement(ExpandMoreIcon, { fontSize: 'inherit' })),
            isEditing ? (React.createElement("input", { type: "text", value: name, onChange: handleNameChange, onKeyPress: handleNameKeyPress })) : (React.createElement("span", { onClick: () => setIsEditing(true) }, subject.name)),
            React.createElement("span", { className: 'workflow-span', style: { marginLeft: 3, marginRight: 3 } }, subject.score),
            React.createElement(AddCircleIcon, { style: { marginLeft: 3 }, fontSize: 'inherit', onClick: handleAddChild }),
            React.createElement(DeleteIcon, { style: { marginLeft: 3 }, fontSize: 'inherit', onClick: handleDelete })),
        isExpanded && renderChildren()));
};
export default SubjectView;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3ViamVjdC52aWV3LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiU3ViamVjdC52aWV3LnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDN0MsT0FBTyxLQUFLLEtBQUssTUFBTSxPQUFPLENBQUM7QUFDL0IsT0FBTyxFQUFDLFVBQVUsRUFBRSxRQUFRLEVBQUMsTUFBTSxPQUFPLENBQUM7QUFDM0MsT0FBTyxjQUFjLE1BQU0sZ0NBQWdDLENBQUM7QUFDNUQsT0FBTyxjQUFjLE1BQU0sZ0NBQWdDLENBQUM7QUFDNUQsT0FBTyxhQUFhLE1BQU0sK0JBQStCLENBQUM7QUFDMUQsT0FBTyxVQUFVLE1BQU0sNEJBQTRCLENBQUM7QUFDcEQsT0FBTyxFQUFDLGdCQUFnQixFQUFDLE1BQU0sNkJBQTZCLENBQUM7QUFDN0QsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLG1DQUFtQyxDQUFDO0FBTTdELE1BQU0sV0FBVyxHQUEyQixDQUFDLEVBQUUsT0FBTyxFQUFFLEVBQUUsRUFBRTtJQUUzRCxNQUFNLG1CQUFtQixHQUFHLFVBQVUsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFBO0lBRXhELE1BQU0sQ0FBQyxVQUFVLEVBQUUsYUFBYSxDQUFDLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3BELE1BQU0sQ0FBQyxTQUFTLEVBQUUsWUFBWSxDQUFDLEdBQUcsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2xELE1BQU0sQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUUvQyxNQUFNLGNBQWMsR0FBRyxHQUFHLEVBQUU7UUFDM0IsTUFBTSxVQUFVLEdBQUcsWUFBWSxDQUFDLFdBQVcsRUFBRSxDQUFBO1FBQzdDLFVBQVUsQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDLEVBQUUsQ0FBQTtRQUNoQyxtQkFB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LElBQUcsT0FBTyxDQUFDLElBQUksQ0FBUSxDQUM5RDtZQUNELDhCQUFNLFNBQVMsRUFBRSxlQUFlLEVBQUUsS0FBSyxFQUFFLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBRSxXQUFXLEVBQUUsQ0FBQyxFQUFDLElBQUcsT0FBTyxDQUFDLEtBQUssQ0FBUTtZQUNoRyxvQkFBQyxhQUFhLElBQUMsS0FBSyxFQUFFLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBQyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsT0FBTyxFQUFFLGNBQWMsR0FBSTtZQUN2RixvQkFBQyxVQUFVLElBQUMsS0FBSyxFQUFFLEVBQUMsVUFBVSxFQUFFLENBQUMsRUFBQyxFQUFFLFFBQVEsRUFBRSxTQUFTLEVBQUUsT0FBTyxFQUFFLFlBQVksR0FBSSxDQUM3RTtRQUNMLFVBQVUsSUFBSSxjQUFjLEVBQUUsQ0FDMUIsQ0FDTixDQUFDO0FBQ0gsQ0FBQyxDQUFDO0FBRUYsZUFBZSxXQUFXLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1N1YmplY3RNb2RlbH0gZnJvbSBcIi4vU3ViamVjdC5tb2RlbFwiO1xyXG5pbXBvcnQgKiBhcyBSZWFjdCBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IHt1c2VDb250ZXh0LCB1c2VTdGF0ZX0gZnJvbSBcInJlYWN0XCI7XHJcbmltcG9ydCBFeHBhbmRMZXNzSWNvbiBmcm9tICdAbXVpL2ljb25zLW1hdGVyaWFsL0V4cGFuZExlc3MnO1xyXG5pbXBvcnQgRXhwYW5kTW9yZUljb24gZnJvbSAnQG11aS9pY29ucy1tYXRlcmlhbC9FeHBhbmRNb3JlJztcclxuaW1wb3J0IEFkZENpcmNsZUljb24gZnJvbSAnQG11aS9pY29ucy1tYXRlcmlhbC9BZGRDaXJjbGUnO1xyXG5pbXBvcnQgRGVsZXRlSWNvbiBmcm9tICdAbXVpL2ljb25zLW1hdGVyaWFsL0RlbGV0ZSc7XHJcbmltcG9ydCB7V29ya1BhbmVsQ29udGV4dH0gZnJvbSBcIi4uL3dvcmtwYW5lbC9Xb3JrUGFuZWwudmlld1wiO1xyXG5pbXBvcnQge1VwZGF0ZU1vZGV9IGZyb20gXCIuLi93b3JrcGFuZWwvV29ya1BhbmVsLmNvbnRyb2xsZXJcIjtcclxuXHJcbmludGVyZmFjZSBTdWJqZWN0UHJvcHMge1xyXG5cdHN1YmplY3Q6IFN1YmplY3RNb2RlbFxyXG59XHJcblxyXG5jb25zdCBTdWJqZWN0VmlldzogUmVhY3QuRkM8U3ViamVjdFByb3BzPiA9ICh7IHN1YmplY3QgfSkgPT4ge1xyXG5cclxuXHRjb25zdCB3b3JrUGFuZWxDb250cm9sbGVyID0gdXNlQ29udGV4dChXb3JrUGFuZWxDb250ZXh0KVxyXG5cclxuXHRjb25zdCBbaXNFeHBhbmRlZCwgc2V0SXNFeHBhbmRlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XHJcblx0Y29uc3QgW2lzRWRpdGluZywgc2V0SXNFZGl0aW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuXHRjb25zdCBbbmFtZSwgc2V0TmFtZV0gPSB1c2VTdGF0ZShzdWJqZWN0Lm5hbWUpO1xyXG5cclxuXHRjb25zdCBoYW5kbGVBZGRDaGlsZCA9ICgpID0+IHtcclxuXHRcdGNvbnN0IG5ld1N1YmplY3QgPSBTdWJqZWN0TW9kZWwubmV3SW5zdGFuY2UoKVxyXG5cdFx0bmV3U3ViamVjdC5wYXJlbnRJRCA9IHN1YmplY3QuaWRcclxuXHRcdHdvcmtQYW5lbENvbnRyb2xsZXIudXBkYXRlU3ViamVjdChuZXdTdWJqZWN0LCBVcGRhdGVNb2RlLkFERClcclxuXHRcdHNldElzRXhwYW5kZWQodHJ1ZSk7XHJcblx0fTtcclxuXHJcblx0Y29uc3QgaGFuZGxlRGVsZXRlID0gKCkgPT4ge1xyXG5cdFx0d29ya1BhbmVsQ29udHJvbGxlci51cGRhdGVTdWJqZWN0KHN1YmplY3QsIFVwZGF0ZU1vZGUuREVMRVRFKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBoYW5kbGVVcGRhdGVOYW1lID0gKCkgPT4ge1xyXG5cdFx0Y29uc3QgbmV3U3ViamVjdCA9IE9iamVjdC5hc3NpZ24oe30sIHN1YmplY3QsIHtuYW1lOiBuYW1lfSlcclxuXHRcdHdvcmtQYW5lbENvbnRyb2xsZXIudXBkYXRlU3ViamVjdChuZXdTdWJqZWN0KVxyXG5cdFx0c2V0SXNFZGl0aW5nKGZhbHNlKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBoYW5kbGVDYW5jZWxFZGl0ID0gKCkgPT4ge1xyXG5cdFx0c2V0SXNFZGl0aW5nKGZhbHNlKTtcclxuXHRcdHNldE5hbWUoc3ViamVjdC5uYW1lKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBoYW5kbGVFeHBhbmQgPSAoKSA9PiB7XHJcblx0XHRzZXRJc0V4cGFuZGVkKCFpc0V4cGFuZGVkKTtcclxuXHR9O1xyXG5cclxuXHRjb25zdCBoYW5kbGVOYW1lQ2hhbmdlID0gKGV2ZW50OiBSZWFjdC5DaGFuZ2VFdmVudDxIVE1MSW5wdXRFbGVtZW50PikgPT4ge1xyXG5cdFx0c2V0TmFtZShldmVudC50YXJnZXQudmFsdWUpO1xyXG5cdH07XHJcblxyXG5cdGNvbnN0IGhhbmRsZU5hbWVLZXlQcmVzcyA9IChldmVudDogUmVhY3QuS2V5Ym9hcmRFdmVudDxIVE1MSW5wdXRFbGVtZW50PikgPT4ge1xyXG5cdFx0aWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJykge1xyXG5cdFx0XHRoYW5kbGVVcGRhdGVOYW1lKCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0Y29uc3QgcmVuZGVyQ2hpbGRyZW4gPSAoKSA9PiB7XHJcblx0XHRpZiAoc3ViamVjdC5jaGlsZHJlbi5sZW5ndGggPT09IDApIHtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gKFxyXG5cdFx0XHQ8ZGl2IHN0eWxlPXt7bWFyZ2luTGVmdDogMjB9fT5cclxuXHRcdFx0XHR7c3ViamVjdC5jaGlsZHJlbi5tYXAoKGNoaWxkKSA9PiAoXHJcblx0XHRcdFx0XHQ8U3ViamVjdFZpZXdcclxuXHRcdFx0XHRcdFx0c3ViamVjdD17Y2hpbGR9XHJcblx0XHRcdFx0XHQvPlxyXG5cdFx0XHRcdCkpfVxyXG5cdFx0XHQ8L2Rpdj5cclxuXHRcdCk7XHJcblx0fTtcclxuXHJcblx0cmV0dXJuIChcclxuXHRcdDxkaXYgc3R5bGU9e3ttYXhIZWlnaHQ6IDQwMCwgb3ZlcmZsb3dZOiAnc2Nyb2xsJ319PlxyXG5cdFx0XHQ8ZGl2IGNsYXNzTmFtZT17J3dvcmtmbG93LWNvbnRhaW5lci1pbm5lcid9IHN0eWxlPXt7IGRpc3BsYXk6ICdmbGV4JywgZmxleERpcmVjdGlvbjogJ3JvdycsIGFsaWduSXRlbXM6ICdjZW50ZXInLCBtYXJnaW5Ub3A6IDN9fT5cclxuXHRcdFx0XHQ8ZGl2IHN0eWxlPXt7ZGlzcGxheTogJ2ZsZXgnLCBhbGlnbkl0ZW1zOiAnY2VudGVyJywgbWFyZ2luUmlnaHQ6IDN9fSBvbkNsaWNrPXtoYW5kbGVFeHBhbmR9Pntpc0V4cGFuZGVkID8gPEV4cGFuZExlc3NJY29uIGZvbnRTaXplPXsnaW5oZXJpdCd9IC8+IDogPEV4cGFuZE1vcmVJY29uIGZvbnRTaXplPXsnaW5oZXJpdCd9Lz59PC9kaXY+XHJcblx0XHRcdFx0e2lzRWRpdGluZyA/IChcclxuXHRcdFx0XHRcdDxpbnB1dFxyXG5cdFx0XHRcdFx0XHR0eXBlPVwidGV4dFwiXHJcblx0XHRcdFx0XHRcdHZhbHVlPXtuYW1lfVxyXG5cdFx0XHRcdFx0XHRvbkNoYW5nZT17aGFuZGxlTmFtZUNoYW5nZX1cclxuXHRcdFx0XHRcdFx0b25LZXlQcmVzcz17aGFuZGxlTmFtZUtleVByZXNzfVxyXG5cdFx0XHRcdFx0Lz5cclxuXHRcdFx0XHQpIDogKFxyXG5cdFx0XHRcdFx0PHNwYW4gb25DbGljaz17KCkgPT4gc2V0SXNFZGl0aW5nKHRydWUpfT57c3ViamVjdC5uYW1lfTwvc3Bhbj5cclxuXHRcdFx0XHQpfVxyXG5cdFx0XHRcdDxzcGFuIGNsYXNzTmFtZT17J3dvcmtmbG93LXNwYW4nfSBzdHlsZT17e21hcmdpbkxlZnQ6IDMsIG1hcmdpblJpZ2h0OiAzfX0+e3N1YmplY3Quc2NvcmV9PC9zcGFuPlxyXG5cdFx0XHRcdDxBZGRDaXJjbGVJY29uIHN0eWxlPXt7bWFyZ2luTGVmdDogM319IGZvbnRTaXplPXsnaW5oZXJpdCd9IG9uQ2xpY2s9e2hhbmRsZUFkZENoaWxkfSAvPlxyXG5cdFx0XHRcdDxEZWxldGVJY29uIHN0eWxlPXt7bWFyZ2luTGVmdDogM319IGZvbnRTaXplPXsnaW5oZXJpdCd9IG9uQ2xpY2s9e2hhbmRsZURlbGV0ZX0gLz5cclxuXHRcdFx0PC9kaXY+XHJcblx0XHRcdHtpc0V4cGFuZGVkICYmIHJlbmRlckNoaWxkcmVuKCl9XHJcblx0XHQ8L2Rpdj5cclxuXHQpO1xyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgU3ViamVjdFZpZXdcclxuIl19